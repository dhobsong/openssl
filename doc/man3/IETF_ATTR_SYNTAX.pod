=pod

=head1 NAME

IETF_ATTR_SYNTAX,
IETF_ATTR_SYNTAX_get0_policyAuthority,
IETF_ATTR_SYNTAX_set0_policyAuthority,
IETF_ATTR_SYNTAX_get_value_num,
IETF_ATTR_SYNTAX_get0_value,
IETF_ATTR_SYNTAX_add1_value
- Accessors and setters for IETF_ATTR_SYNTAX

=head1 SYNOPSIS

 typedef struct IETF_ATTR_SYNTAX_st IETF_ATTR_SYNTAX;

 const GENERAL_NAMES *
 IETF_ATTR_SYNTAX_get0_policyAuthority(const IETF_ATTR_SYNTAX *a);
 void IETF_ATTR_SYNTAX_set0_policyAuthority(IETF_ATTR_SYNTAX *a, GENERAL_NAMES *names);

 int IETF_ATTR_SYNTAX_get_value_num(const IETF_ATTR_SYNTAX *a);
 void *IETF_ATTR_SYNTAX_get0_value(const IETF_ATTR_SYNTAX *a, int ind, int *type);
 int IETF_ATTR_SYNTAX_add1_value(IETF_ATTR_SYNTAX *a, int type, void *data);

=head1 DESCRIPTION

B<IETF_ATTR_SYNTAX> is an opaque structure that represents the
IetfAttrSyntax type defined in RFC 5755 (Section 4.4) for use
as an AttributeValue.

IETF_ATTR_SYNTAX_get0_policyAuthority() and IETF_ATTR_SYNTAX_set0_policyAuthority()
get and set the policyAuthority field of the structure. Both routines act on
internal pointers of the structure and must not be freed by the application.

An B<IETF_ATTR_SYNTAX> object also holds a sequence of values.
IETF_ATTR_SYNTAX_get_value_num() returns the number of values in the
sequence.  IETF_ATTR_SYNTAX_add1_value(), adds a copy of I<data> of a specified
I<type> to the sequence.  The caller should free the I<data> after use.

IETF_ATTR_SYNTAX_get0_value() will return the value and a specific index I<ind>
in the sequence or NULL on error.  If I<type> is not NULL, the type of the
value will be written to this location.

The I<type> of the values stored in the B<IETF_ATTR_SYNTAX> value sequence is
one of the following:

=over 4

=item IETFAS_OCTETS

A pointer to an ASN1_OCTET_STRING

=item IETFAS_OID

A pointer to an ASN1_OBJECT

=item IETFAS_STRING

A pointer to an ASN1_UTF8STRING

=back

=head1 RETURN VALUES

IETF_ATTR_SYNTAX_get0_policyAuthority() returns an pointer to a
B<GENERAL_NAMES> structure or B<NULL> if the policy authority has not been
set.

IETF_ATTR_SYNTAX_get_value_num() returns the number of entries in the value
sequence or -1 on error.

IETF_ATTR_SYNTAX_get0_value() returns a pointer to the value at the given index
or NULL if the index is out of range.

IETF_ATTR_SYNTAX_add1_value() returns 1 on success and 0 on failure.

=head1 COPYRIGHT

Copyright 2021 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the Apache License 2.0 (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
